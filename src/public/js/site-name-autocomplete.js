let siteName=document.getElementById("siteName"),autocompleteContainer=document.getElementById("autocomplete-container");function autocomplete(e){siteName.value=e}function autocompleteFocus(e,t){-1!=e&&autocompleteContainer.children[e].classList.remove("autocomplete-focus"),autocompleteContainer.children[t].classList.add("autocomplete-focus")}siteName.addEventListener("input",(function(e){const t=encodeURIComponent(this.value);updateUrl="/sites-autocomplete/"+t,t.length>0?fetch(updateUrl).then((function(e){return console.log("Searching for site "+t+"'"),e.text()})).then((function(e){autocompleteContainer.style.display="block",autocompleteContainer.innerHTML=e})).catch((function(e){console.warn("Something went wrong.",e)})):autocompleteContainer.innerHTML=""})),siteName.addEventListener("focus",(function(){autocompleteContainer.style.display="block"})),document.addEventListener("click",(function(e){e.target!=autocompleteContainer&&e.target!=siteName&&(autocompleteContainer.style.display="none")})),currentFocus=-1,siteName.addEventListener("keydown",(function(e){switch(currentFocus>=autocompleteContainer.children.length&&(currentFocus=autocompleteContainer.children.length-1),e.code){case"ArrowUp":0!=autocompleteContainer.children.length&&currentFocus>0&&autocompleteFocus(currentFocus,--currentFocus);break;case"ArrowDown":0!=autocompleteContainer.children.length&&currentFocus<autocompleteContainer.children.length-1&&autocompleteFocus(currentFocus,++currentFocus);break;case"Escape":siteName.blur(),autocompleteContainer.style.display="none";break;case"Enter":-1!=currentFocus&&(e.preventDefault(),autocomplete(autocompleteContainer.children[currentFocus].innerHTML),autocompleteContainer.children[currentFocus].classList.remove("autocomplete-focus"),currentFocus=-1)}}));
