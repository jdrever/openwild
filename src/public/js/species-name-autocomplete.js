let speciesName=document.getElementById("speciesName"),autocompleteContainer=document.getElementById("autocomplete-container");function autocomplete(e){speciesName.value=e}function autocompleteFocus(e,t){-1!=e&&autocompleteContainer.children[e].classList.remove("autocomplete-focus"),autocompleteContainer.children[t].classList.add("autocomplete-focus")}speciesName.addEventListener("input",(function(e){const t=encodeURIComponent(this.value);let o=document.querySelector('input[name="speciesNameType"]:checked').value+"Name",n=document.querySelector('input[name="speciesGroup"]:checked').value;n=n[0].toUpperCase()+n.slice(1),updateUrl="/species-autocomplete/"+t+"/"+o+"/"+n,t.length>0?fetch(updateUrl).then((function(e){return console.log("Searching for "+o+" '"+t+"'"),e.text()})).then((function(e){autocompleteContainer.style.display="block",autocompleteContainer.innerHTML=e})).catch((function(e){console.warn("Something went wrong.",e)})):autocompleteContainer.innerHTML=""})),speciesName.addEventListener("focus",(function(){autocompleteContainer.style.display="block"})),document.addEventListener("click",(function(e){e.target!=autocompleteContainer&&e.target!=speciesName&&(autocompleteContainer.style.display="none")})),currentFocus=-1,speciesName.addEventListener("keydown",(function(e){switch(currentFocus>=autocompleteContainer.children.length&&(currentFocus=autocompleteContainer.children.length-1),e.code){case"ArrowUp":0!=autocompleteContainer.children.length&&currentFocus>0&&autocompleteFocus(currentFocus,--currentFocus);break;case"ArrowDown":0!=autocompleteContainer.children.length&&currentFocus<autocompleteContainer.children.length-1&&autocompleteFocus(currentFocus,++currentFocus);break;case"Escape":speciesName.blur(),autocompleteContainer.style.display="none";break;case"Enter":-1!=currentFocus&&(e.preventDefault(),autocomplete(autocompleteContainer.children[currentFocus].innerHTML),autocompleteContainer.children[currentFocus].classList.remove("autocomplete-focus"),currentFocus=-1)}}));
